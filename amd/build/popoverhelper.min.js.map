{"version":3,"file":"popoverhelper.min.js","sources":["../src/popoverhelper.js"],"sourcesContent":["define(['jquery', 'core/log', 'mod_readaloud/definitions', 'mod_readaloud/dependencyloader', 'theme_boost/popover'], function ($, log, def) {\r\n    \"use strict\"; // jshint ;_;\r\n\r\n    /*\r\n    This file is to\r\n     */\r\n\r\n    log.debug('Read Aloud Popover helper: initialising');\r\n\r\n    return {\r\n\r\n        lastitem: false,\r\n        okbuttonclass: def.okbuttonclass,\r\n        ngbuttonclass: def.ngbuttonclass,\r\n        quickgradecontainerclass: def.quickgradecontainerclass,\r\n        quickgradetitle: M.util.get_string('quickgrade', def.component),\r\n        transcripttitle: M.util.get_string('transcript', def.component),\r\n        oklabel: M.util.get_string('ok', def.component),\r\n        nglabel: M.util.get_string('ng', def.component),\r\n        dispose: false, //Bv4 = dispose  Bv3 = destroy\r\n\r\n        init: function () {\r\n            this.register_events();\r\n        },\r\n\r\n        register_events: function () {\r\n            $(document).on('click', '.' + this.okbuttonclass, this.onAccept);\r\n            $(document).on('click', '.' + this.ngbuttonclass, this.onReject);\r\n        },\r\n\r\n        //different bootstrap/popover versions have a different word for \"dispose\" so this method bridges that.\r\n        //we can not be sure what version is installed\r\n        disposeWord: function () {\r\n            if (this.dispose) {\r\n                return this.dispose;\r\n            }\r\n            var version = '3';\r\n            if ($.fn.popover.Constructor.hasOwnProperty('VERSION')) {\r\n                version = $.fn.popover.Constructor.VERSION.charAt(0);\r\n            }\r\n            switch (version) {\r\n                case '4':\r\n                    this.dispose = 'dispose';\r\n                    break;\r\n                case '3':\r\n                default:\r\n                    this.dispose = 'destroy';\r\n                    break;\r\n            }\r\n            return this.dispose;\r\n        },\r\n\r\n        remove: function (item) {\r\n            if (item) {\r\n                $(item).popover(this.disposeWord());\r\n            } else if (this.lastitem) {\r\n                $(this.lastitem).popover(this.disposeWord());\r\n                this.lastitem = false;\r\n            }\r\n        },\r\n\r\n        addQuickGrader: function (item) {\r\n\r\n            //dispose of previous popover, and remember this one\r\n            if (this.lastitem && this.lastitem !== item) {\r\n                $(this.lastitem).popover(this.disposeWord());\r\n                this.lastitem = false;\r\n            }\r\n            this.lastitem = item;\r\n            var that = this;\r\n\r\n            var thefunc = function () {\r\n                var wordnumber = $(this).data(\"wordnumber\");\r\n                var okbutton = \"<button type='button' class='btn \" + that.okbuttonclass + \"' data-wordnumber='\" + wordnumber + \"'><i class='fa fa-check'></i> \" + that.oklabel + \"</button>\";\r\n                var ngbutton = \"<button type='button' class='btn \" + that.ngbuttonclass + \"' data-wordnumber='\" + wordnumber + \"'><i class='fa fa-close'></i> \" + that.nglabel + \"</button>\";\r\n                var container = \"<div class='\" + that.quickgradecontainerclass + \"'>\" + okbutton + ngbutton + \"</div>\";\r\n                return $(container);\r\n            };\r\n\r\n            //lets add the popover\r\n            $(item).popover({\r\n                title: this.quickgradetitle,\r\n                content: thefunc,\r\n                trigger: 'manual',\r\n                placement: 'top',\r\n                html: true\r\n            });\r\n            $(item).popover('show');\r\n        },\r\n\r\n        addTranscript: function (item, transcript) {\r\n\r\n            //if we are already showing this item then dispose of it, set last item to null and go home\r\n            if (this.lastitem === item) {\r\n                $(this.lastitem).popover(this.disposeWord());\r\n                this.lastitem = false;\r\n                return;\r\n            }\r\n\r\n            //dispose of previous popover, and remember this one\r\n            if (this.lastitem) {\r\n                $(this.lastitem).popover(this.disposeWord());\r\n                this.lastitem = false;\r\n            }\r\n            this.lastitem = item;\r\n\r\n            //lets add the popover\r\n            $(item).popover({\r\n                title: this.transcripttitle,\r\n                content: transcript,\r\n                trigger: 'manual',\r\n                placement: 'top'\r\n            });\r\n            $(item).popover('show');\r\n        },\r\n\r\n        //these two functions are overridden by the calling class\r\n        onAccept: function () {\r\n            alert($(this).attr('data-wordnumber'));\r\n        },\r\n        onReject: function () {\r\n            alert($(this).attr('data-wordnumber'));\r\n        }\r\n\r\n    };//end of return value\r\n});"],"names":["define","$","log","def","debug","lastitem","okbuttonclass","ngbuttonclass","quickgradecontainerclass","quickgradetitle","M","util","get_string","component","transcripttitle","oklabel","nglabel","dispose","init","register_events","document","on","this","onAccept","onReject","disposeWord","version","fn","popover","Constructor","hasOwnProperty","VERSION","charAt","remove","item","addQuickGrader","that","title","content","wordnumber","data","okbutton","ngbutton","container","trigger","placement","html","addTranscript","transcript","alert","attr"],"mappings":"AAAAA,qCAAO,CAAC,SAAU,WAAY,4BAA6B,iCAAkC,wBAAwB,SAAUC,EAAGC,IAAKC,YAOnID,IAAIE,MAAM,2CAEH,CAEHC,UAAU,EACVC,cAAeH,IAAIG,cACnBC,cAAeJ,IAAII,cACnBC,yBAA0BL,IAAIK,yBAC9BC,gBAAiBC,EAAEC,KAAKC,WAAW,aAAcT,IAAIU,WACrDC,gBAAiBJ,EAAEC,KAAKC,WAAW,aAAcT,IAAIU,WACrDE,QAASL,EAAEC,KAAKC,WAAW,KAAMT,IAAIU,WACrCG,QAASN,EAAEC,KAAKC,WAAW,KAAMT,IAAIU,WACrCI,SAAS,EAETC,KAAM,gBACGC,mBAGTA,gBAAiB,WACblB,EAAEmB,UAAUC,GAAG,QAAS,IAAMC,KAAKhB,cAAegB,KAAKC,UACvDtB,EAAEmB,UAAUC,GAAG,QAAS,IAAMC,KAAKf,cAAee,KAAKE,WAK3DC,YAAa,cACLH,KAAKL,eACEK,KAAKL,YAEZS,QAAU,OACVzB,EAAE0B,GAAGC,QAAQC,YAAYC,eAAe,aACxCJ,QAAUzB,EAAE0B,GAAGC,QAAQC,YAAYE,QAAQC,OAAO,IAG7C,MADDN,aAEKT,QAAU,oBAIVA,QAAU,iBAGhBK,KAAKL,SAGhBgB,OAAQ,SAAUC,MACVA,KACAjC,EAAEiC,MAAMN,QAAQN,KAAKG,eACdH,KAAKjB,WACZJ,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,oBACzBpB,UAAW,IAIxB8B,eAAgB,SAAUD,MAGlBZ,KAAKjB,UAAYiB,KAAKjB,WAAa6B,OACnCjC,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,oBACzBpB,UAAW,QAEfA,SAAW6B,SACZE,KAAOd,KAWXrB,EAAEiC,MAAMN,QAAQ,CACZS,MAAOf,KAAKb,gBACZ6B,QAXU,eACNC,WAAatC,EAAEqB,MAAMkB,KAAK,cAC1BC,SAAW,oCAAsCL,KAAK9B,cAAgB,sBAAwBiC,WAAa,iCAAmCH,KAAKrB,QAAU,YAC7J2B,SAAW,oCAAsCN,KAAK7B,cAAgB,sBAAwBgC,WAAa,iCAAmCH,KAAKpB,QAAU,YAC7J2B,UAAY,eAAiBP,KAAK5B,yBAA2B,KAAOiC,SAAWC,SAAW,gBACvFzC,EAAE0C,YAOTC,QAAS,SACTC,UAAW,MACXC,MAAM,IAEV7C,EAAEiC,MAAMN,QAAQ,SAGpBmB,cAAe,SAAUb,KAAMc,eAGvB1B,KAAKjB,WAAa6B,YAClBjC,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,yBACzBpB,UAAW,GAKhBiB,KAAKjB,WACLJ,EAAEqB,KAAKjB,UAAUuB,QAAQN,KAAKG,oBACzBpB,UAAW,QAEfA,SAAW6B,KAGhBjC,EAAEiC,MAAMN,QAAQ,CACZS,MAAOf,KAAKR,gBACZwB,QAASU,WACTJ,QAAS,SACTC,UAAW,QAEf5C,EAAEiC,MAAMN,QAAQ,SAIpBL,SAAU,WACN0B,MAAMhD,EAAEqB,MAAM4B,KAAK,qBAEvB1B,SAAU,WACNyB,MAAMhD,EAAEqB,MAAM4B,KAAK"}