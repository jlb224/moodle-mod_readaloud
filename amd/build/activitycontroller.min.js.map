{"version":3,"file":"activitycontroller.min.js","sources":["../src/activitycontroller.js"],"sourcesContent":["/* jshint ignore:start */\ndefine(['jquery', 'core/log', \"core/str\",'mod_readaloud/definitions',\n        'mod_readaloud/recorderhelper', 'mod_readaloud/modelaudiokaraoke',\n        'core/ajax','core/notification','mod_readaloud/smallreporthelper',\n        'mod_readaloud/listenandrepeat','mod_readaloud/quizhelper'],\n    function ($, log, str,def, recorderhelper, modelaudiokaraoke,\n              Ajax, notification, smallreporthelper, landr, quizhelper) {\n\n    \"use strict\"; // jshint ;_;\n\n    log.debug('Activity controller: initialising');\n\n    return {\n\n        cmid: null,\n        activitydata: null,\n        holderid: null,\n        recorderid: null,\n        playerid: null,\n        sorryboxid: null,\n        controls: null,\n        ra_recorder: null,\n        rec_time_start: 0,\n        enableshadow: false,\n        enablepreview: false,\n        enablelandr: false,\n        letsshadow: false,\n        strings: {},\n\n\n        //CSS in this file\n        passagefinished: def.passagefinished,\n\n        //for making multiple instances\n        clone: function () {\n            return $.extend(true, {}, this);\n        },\n\n        //pass in config, the jquery video/audio object, and a function to be called when conversion has finshed\n        init: function (props) {\n            var dd = this.clone();\n\n            //pick up opts from html\n            var theid = '#amdopts_' + props.widgetid;\n            var configcontrol = $(theid).get(0);\n            if (configcontrol) {\n                dd.activitydata = JSON.parse(configcontrol.value);\n                $(theid).remove();\n            } else {\n                //if there is no config we might as well give up\n                log.debug('Read Aloud Test Controller: No config found on page. Giving up.');\n                return;\n            }\n\n            dd.cmid = props.cmid;\n            dd.holderid = props.widgetid + '_holder';\n            dd.recorderid = props.widgetid + '_recorder';\n            dd.playerid = props.widgetid + '_player';\n            dd.sorryboxid = props.widgetid + '_sorrybox';\n\n            //if the browser doesn't support html5 recording.\n            //then warn and do not go any further\n            if (!dd.is_browser_ok()) {\n                $('#' + dd.sorryboxid).show();\n                return;\n            }\n\n            // Set up model audio.\n            dd.enableshadow =dd.activitydata.enableshadow;\n            dd.enablepreview =dd.activitydata.enablepreview;\n            dd.enablelandr =dd.activitydata.enablelandr;\n            dd.setupmodelaudio();\n\n            // Set up listen and repeat.\n            dd.setuplandr();\n\n            // Init recorder and html and events.\n            dd.setup_recorder();\n            dd.process_html(dd.activitydata);\n            // if (dd.activitydata.quizcontainer) {\n            //     dd.activitydata.audioplayerclass = this.controls.quizcontainer;\n            // }\n\n            dd.register_events();\n            dd.setup_strings();\n\n            //Set up quiz\n            dd.setupquiz();\n\n            //set initial mode\n            //we used to check the settings but now we just show the non-options greyed out\n            if(dd.enableshadow || dd.enablepreview || true){\n                dd.domenulayout();\n            }else{\n                dd.doreadinglayout();\n            }\n        },\n\n        setup_strings: function(){\n            var dd = this;\n            // Set up strings\n            str.get_strings([\n                { \"key\": \"confirm_cancel_recording\", \"component\": def.component}\n                //more strings here\n            ]).done(function (s) {\n                var i = 0;\n                dd.strings.confirm_cancel_recording= s[i++];\n                //more strings here\n            });\n        },\n\n        setupmodelaudio: function(){\n            var karaoke_opts={breaks:this.activitydata.breaks, audioplayerclass:this.activitydata.audioplayerclass };\n            modelaudiokaraoke.init(karaoke_opts);\n        },\n\n        setuplandr: function(){\n            var landr_opts={modelaudiokaraoke: modelaudiokaraoke, cmid: this.cmid, language: this.activitydata.language,\n                region: this.activitydata.region, phonetics: this.activitydata.phonetics, stt_guided: this.activitydata.stt_guided};\n            landr.init(landr_opts);\n        },\n\n        setupquiz: function(){\n            var dd = this;\n            //hack TO DO - get the real attempt id\n            dd.attemptid = 1;\n\n            quizhelper.init(dd.controls.quizcontainer,\n                dd.activitydata,\n                dd.cmid,\n                dd.attemptid);\n        },\n\n        process_html: function (opts) {\n\n            //these css classes/ids are all passed in from php in\n            //renderer.php::fetch_activity_amd should maybe just simplify and declare them in definitions.js\n            var controls = {\n                hider: $('.' + opts['hider']),\n                introbox: $('.' + 'mod_intro_box'),\n                progresscontainer: $('.' + opts['progresscontainer']),\n                feedbackcontainer: $('.' + opts['feedbackcontainer']),\n                errorcontainer: $('.' + opts['errorcontainer']),\n                passagecontainer: $('.' + opts['passagecontainer']),\n                recordingcontainer: $('.' + opts['recordingcontainer']),\n                dummyrecorder: $('.' + opts['dummyrecorder']),\n                recordercontainer: $('.' + opts['recordercontainer']),\n                menubuttonscontainer: $('.' + opts['menubuttonscontainer']),\n                menuinstructionscontainer: $('.' + opts['menuinstructionscontainer']),\n                previewinstructionscontainer: $('.' + opts['previewinstructionscontainer']),\n                landrinstructionscontainer: $('.' + opts['landrinstructionscontainer']),\n                activityinstructionscontainer: $('.' + opts['activityinstructionscontainer']),\n                recinstructionscontainerright: $('.' + opts['recinstructionscontainerright']),\n                recinstructionscontainerleft: $('.' + opts['recinstructionscontainerleft']),\n                allowearlyexit: $('.' + opts['allowearlyexit']),\n                wheretonextcontainer: $('.' + opts['wheretonextcontainer']),\n                modelaudioplayer: $('#' + opts['modelaudioplayer']),\n                startlandrbutton: $('#' + opts['startlandrbutton']),\n                homebutton: $('#' + opts['homebutton']),\n                startpreviewbutton: $('#' + opts['startpreviewbutton']),\n                startreadingbutton: $('#' + opts['startreadingbutton']),\n                startreportbutton: $('#' + opts['startreportbutton']),\n                startshadowbutton: $('#' + opts['startshadowbutton']),\n                startquizbutton: $('#' + opts['startquizbutton']),\n                returnmenubutton: $('#' + opts['returnmenubutton']),\n                stopandplay: $('#' + opts['stopandplay']),\n                smallreportcontainer: $('#' + opts['smallreportcontainer']),\n                readingcontainer: $('#' + def.readingcontainer),\n                modeimagecontainer: $('#' + opts['modeimagecontainer']),\n                quizcontainer: $('.' +  opts['quizcontainer']),\n                homecontainer: $('.' +  opts['homecontainer']),\n            };\n            this.controls = controls;\n        },\n\n        is_browser_ok: function () {\n            return (navigator && navigator.mediaDevices\n                && navigator.mediaDevices.getUserMedia);\n        },\n\n        setup_recorder: function () {\n            var dd = this;\n\n            //after the recorder reports that it has (really) started this functuon is called.\n            var beginall= function(){\n                dd.passagerecorded = true;\n                if(dd.enableshadow && dd.letsshadow){\n                    dd.controls.modelaudioplayer[0].play();\n                }\n            };\n\n            var on_speech = function (eventdata) {\n                var speech = eventdata.capturedspeech;\n                var speechresults = eventdata.speechresults;\n            };\n\n            //originates from the recording:started event\n            //contains no meaningful data\n            //See https://api.poodll.com\n            var on_recording_start = function (eventdata) {\n                dd.rec_time_start = new Date().getTime();\n                dd.dopassagelayout();\n\n               // dd.controls.passagecontainer.show(1000, beginall);\n                dd.controls.passagecontainer.show(500,beginall);\n                dd.controls.passagecontainer[0].scrollIntoView({behaviour: \"smooth\", block: \"start\", inline: \"nearest\"});\n\n                /*\n                var scrollparent = $(\"#page\");\n                var newtop = scrollparent.scrollTop() + dd.controls.passagecontainer.offset().top - scrollparent.offset().top;\n                if(newtop<0) {newtop=0;}\n                scrollparent.animate({scrollTop: newtop}, 500,beginall);\n                */\n\n            };\n\n            //originates from the recording:ended event\n            //contains no meaningful data\n            //See https://api.poodll.com\n            var on_recording_end = function (eventdata) {\n                //its a bit hacky but the rec end event can arrive immed. somehow probably when the mic test ends\n                var now = new Date().getTime();\n                if ((now - dd.rec_time_start) < 3000) {\n                    return;\n                }\n                dd.douploadlayout();\n                //if we are shadowing we should stop the audio player.\n                if(dd.enableshadow && dd.letsshadow){\n                    dd.controls.modelaudioplayer[0].currentTime=0;\n                    dd.controls.modelaudioplayer[0].pause();\n                }\n            };\n\n            //data sent here originates from the awaiting_processing event\n            //See https://api.poodll.com\n            var on_audio_processing = function (eventdata) {\n                //at this point we know the submission has been uploaded and we know the fileURL\n                //so we send the submission\n                var now = new Date().getTime();\n                var rectime = now - dd.rec_time_start;\n                if (rectime > 0) {\n                    rectime = Math.ceil(rectime / 1000);\n                }\n\n                dd.send_submission(eventdata.mediaurl, rectime);\n                //and let the user know that they are all done\n                dd.dofinishedlayout();\n            };\n\n            //init the recorder\n            recorderhelper.init(dd.activitydata,\n                on_recording_start,\n                on_recording_end,\n                on_audio_processing,\n                on_speech);\n        },\n\n        register_events: function () {\n            var dd = this;\n\n            dd.controls.startpreviewbutton.click(function(e){\n                dd.dopreviewlayout();\n            });\n            dd.controls.startpreviewbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13 ) {\n                    dd.dopreviewlayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.startlandrbutton.click(function(e){\n                dd.dolandrlayout();\n            });\n            dd.controls.startlandrbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13 ) {\n                    dd.dolandrlayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.startreadingbutton.click(function(e){\n                dd.letsshadow=false;\n                dd.doreadinglayout();\n            });\n            dd.controls.startreadingbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13) {\n                    dd.letsshadow=false;\n                    dd.doreadinglayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.startshadowbutton.click(function(e){\n                //landr shadowing\n                //dd.dolandrlayout();\n                // landr.shadow=true;\n\n                dd.letsshadow=true;\n                dd.doreadinglayout();\n            });\n            dd.controls.startshadowbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13) {\n                    //dd.dolandrlayout();\n                    //landr.shadow=true;\n\n                    dd.letsshadow=true;\n                    dd.doreadinglayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.returnmenubutton.click(function(e){\n                //in most cases ajax hide show is ok, but L&R stuffs up android for normal readaloud so we reload\n                if(dd.isandroid() && dd.controls.landrinstructionscontainer.is(\":visible\")) {\n                    location.reload();\n                }else if(dd.controls.readingcontainer.is(\":visible\")\n                    && dd.controls.passagecontainer.hasClass('readmode')\n                    && dd.controls.passagecontainer.is(\":visible\")){\n                    // Display a confirmation dialog\n                    var result = confirm(dd.strings.confirm_cancel_recording);\n                    //there is no way to stop the recorder early, so just reload the page, brutal\n                    if (result) {\n                        location.reload();\n                    }\n                }else {\n                    dd.controls.modelaudioplayer[0].currentTime = 0;\n                    dd.controls.modelaudioplayer[0].pause();\n                    dd.domenulayout();\n                }\n            });\n            dd.controls.startreportbutton.click(function(e){\n                dd.doreportlayout();\n            });\n            dd.controls.startquizbutton.click(function(e){\n                dd.doquizlayout();\n            });\n            dd.controls.startquizbutton.keypress(function(e){\n                if (e.which == 32 || e.which == 13 ) {\n                    dd.doquizlayout();\n                    e.preventDefault();\n                }\n            });\n            dd.controls.homebutton.click(function(e){\n                dd.dohomelayout();\n            });\n        },\n\n        send_submission: function (filename, rectime) {\n            var that = this;\n            var shadowing = (that.enableshadow && that.letsshadow) ? 1 : 0;\n            Ajax.call([{\n                methodname: 'mod_readaloud_submit_regular_attempt',\n                args: {\n                    cmid: that.cmid,\n                    filename:  filename,//encodeURIComponent(filename),\n                    rectime: rectime,\n                    shadowing: shadowing\n                },\n                done: function(ajaxresult){\n                    var payloadobject = JSON.parse(ajaxresult);\n                    if (payloadobject) {\n                        switch (payloadobject.success) {\n                            case true:\n                                log.debug('attempted submission accepted');\n                                break;\n                            case false:\n                            default:\n                                log.debug('attempted item evaluation failure');\n                                if (payloadobject.message) {\n                                    log.debug('message: ' + payloadobject.message);\n                                }\n                        }\n                    }\n                },\n                fail: notification.exception\n            }]);\n/*\n            return;\n\n            //set up our ajax request\n            var xhr = new XMLHttpRequest();\n            var that = this;\n\n            //set up our handler for the response\n            xhr.onreadystatechange = function (e) {\n                if (this.readyState === 4) {\n                    if (xhr.status === 200) {\n                        log.debug('ok we got an attempt submission response');\n                        //get a yes or forgetit or tryagain\n                        var payload = xhr.responseText;\n                        var payloadobject = JSON.parse(payload);\n                        if (payloadobject) {\n                            switch (payloadobject.success) {\n                                case true:\n                                    log.debug('attempted submission accepted');\n\n                                    break;\n\n                                case false:\n                                default:\n                                    log.debug('attempted item evaluation failure');\n                                    if (payloadobject.message) {\n                                        log.debug('message: ' + payloadobject.message);\n                                    }\n                            }\n                        }\n                    } else {\n                        log.debug('Not 200 response:' + xhr.status);\n                    }\n                }\n            };\n\n            //to get through mod_security environments\n            filename = filename.replace(/^https:\\/\\//i, 'https___');\n            var params = \"cmid=\" + that.cmid + \"&filename=\" + encodeURIComponent(filename) + \"&rectime=\" + rectime;\n            xhr.open(\"POST\", M.cfg.wwwroot + '/mod/readaloud/ajaxhelper.php', true);\n            xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n            xhr.setRequestHeader(\"Cache-Control\", \"no-cache\");\n            xhr.send(params);\n*/\n        },\n\n        doreadinglayout: function () {\n            var m = this;\n            m.controls.hider.fadeOut('fast');\n            m.controls.activityinstructionscontainer.show();\n            m.controls.recordingcontainer.show();\n            m.controls.introbox.hide();\n            m.controls.menuinstructionscontainer.hide();\n            m.controls.menubuttonscontainer.hide();\n            m.controls.homecontainer.hide();\n            m.controls.smallreportcontainer.hide();\n            m.controls.returnmenubutton.show();\n            m.controls.progresscontainer.hide();\n            m.controls.passagecontainer.removeClass('previewmode shadowmode reviewmode nothingmode');\n            m.controls.passagecontainer.addClass('readmode');\n            m.controls.passagecontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.stopandplay.removeClass('visible').addClass('hidden');\n            // m.controls.modeimagecontainer.removeClass('preview landr readaloud readaloudshadow report quiz');\n            // m.controls.modeimagecontainer.addClass('readaloud');\n            m.controls.modeimagecontainer.removeClass('fa-comment fa-comments fa-headphones fa-circle-question fa-chart-simple');\n            m.controls.modeimagecontainer.addClass('fa-book-open-reader');\n\n            modelaudiokaraoke.modeling=true;\n        },\n\n        domenulayout: function () {\n            var m = this;\n            m.controls.introbox.show();\n            m.controls.menuinstructionscontainer.show();\n            // m.controls.menubuttonscontainer.show();\n            m.controls.homecontainer.show();\n            m.controls.smallreportcontainer.show();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.returnmenubutton.hide();\n            m.controls.previewinstructionscontainer.hide();\n\n            m.controls.landrinstructionscontainer.hide();\n            landr.deactivate();\n\n            m.controls.progresscontainer.hide();\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.modelaudioplayer.hide();\n            m.controls.hider.hide();\n            m.controls.stopandplay.removeClass('visible').addClass('hidden');\n            m.controls.readingcontainer.removeClass(def.containerfillscreen);\n\n            modelaudiokaraoke.modeling=true;\n        },\n\n        dopreviewlayout: function () {\n            var m = this;\n            console.log(\"Before:\", m.controls.modeimagecontainer.attr('class'));\n            m.controls.passagecontainer.removeClass('readmode shadowmode reviewmode nothingmode');\n            m.controls.passagecontainer.addClass('previewmode');\n            m.controls.passagecontainer.show();\n            m.controls.previewinstructionscontainer.show();\n            m.controls.landrinstructionscontainer.hide();\n            m.controls.introbox.hide();\n            m.controls.returnmenubutton.show();\n            m.controls.modelaudioplayer.hide();\n            m.controls.smallreportcontainer.hide();\n            m.controls.stopandplay.show();\n            m.controls.menubuttonscontainer.hide();\n            m.controls.homecontainer.hide();\n            m.controls.hider.hide();\n            m.controls.progresscontainer.hide();\n            m.controls.menuinstructionscontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.stopandplay.removeClass('hidden').addClass('visible');\n            // m.controls.modeimagecontainer.removeClass('landr readaloud readaloudshadow report quiz');\n            // m.controls.modeimagecontainer.addClass('preview');\n            m.controls.modeimagecontainer.removeClass('fa-comment fa-comments fa-book-open-reader fa-circle-question fa-chart-simple');\n            m.controls.modeimagecontainer.addClass('fa-headphones');\n            console.log(\"After:\", m.controls.modeimagecontainer.attr('class'));\n\n            modelaudiokaraoke.modeling=false;\n        },\n\n        dolandrlayout: function () {\n            var m = this;\n            m.controls.passagecontainer.removeClass('readmode shadowmode reviewmode nothingmode');\n            m.controls.passagecontainer.addClass('previewmode');\n            m.controls.passagecontainer.show();\n            m.controls.landrinstructionscontainer.show();\n            m.controls.previewinstructionscontainer.hide();\n            m.controls.introbox.hide();\n            m.controls.returnmenubutton.show();\n            m.controls.modelaudioplayer.hide();\n            m.controls.smallreportcontainer.hide();\n            m.controls.menubuttonscontainer.hide();\n            m.controls.homecontainer.hide();\n            m.controls.hider.hide();\n            m.controls.progresscontainer.hide();\n            m.controls.menuinstructionscontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.feedbackcontainer.hide();\n            m.controls.wheretonextcontainer.hide();\n            m.controls.stopandplay.removeClass('hidden').addClass('visible');\n            // m.controls.modeimagecontainer.removeClass('preview readaloud readaloudshadow report quiz');\n            // m.controls.modeimagecontainer.addClass('landr');\n            m.controls.modeimagecontainer.removeClass('fa-headphones fa-comments fa-book-open-reader fa-circle-question fa-chart-simple');\n            m.controls.modeimagecontainer.addClass('fa-comment');\n            landr.activate();\n\n            modelaudiokaraoke.modeling=false;\n\n        },\n\n        dopassagelayout: function () {\n            var m = this;\n            m.controls.introbox.hide();\n            m.controls.readingcontainer.addClass(def.containerfillscreen);\n        },\n\n        douploadlayout: function () {\n            var m = this;\n            m.controls.passagecontainer.addClass(m.passagefinished);\n            m.controls.hider.fadeIn('fast');\n            m.controls.progresscontainer.fadeIn('fast');\n        },\n\n        dofinishedlayout: function () {\n            var m = this;\n            m.controls.hider.fadeOut('fast');\n            m.controls.progresscontainer.fadeOut('fast');\n            m.controls.smallreportcontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.readingcontainer.removeClass(def.containerfillscreen);\n            m.controls.feedbackcontainer.show();\n            m.controls.wheretonextcontainer.show();\n            m.controls.returnmenubutton.hide();\n\n        },\n        doerrorlayout: function () {\n            var m = this;\n            m.controls.hider.fadeOut('fast');\n            m.controls.progresscontainer.fadeOut('fast');\n            m.controls.readingcontainer.removeClass(def.containerfillscreen);\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.errorcontainer.show();\n            m.controls.wheretonextcontainer.show();\n        },\n        doreportlayout: function () {\n            var m = this;\n            m.controls.passagecontainer.hide();\n            m.controls.recordingcontainer.hide();\n            m.controls.activityinstructionscontainer.hide();\n            m.controls.landrinstructionscontainer.hide();\n            m.controls.previewinstructionscontainer.hide();\n            m.controls.smallreportcontainer.show();\n            // m.controls.modeimagecontainer.removeClass('preview readaloud readaloudshadow landr quiz');\n            // m.controls.modeimagecontainer.addClass('report');\n            m.controls.modeimagecontainer.removeClass('fa-headphones fa-comment fa-comments fa-book-open-reader fa-circle-question');\n            m.controls.modeimagecontainer.addClass('fa-chart-simple');\n            m.controls.returnmenubutton.show();\n        },\n        doquizlayout: function(){\n            var m = this;\n\n           // m.controls.instructionscontainer.hide();\n            m.controls.smallreportcontainer.hide();\n            // m.controls.modeimagecontainer.removeClass('preview landr readaloud readaloudshadow report');\n            // m.controls.modeimagecontainer.addClass('quiz');\n            m.controls.modeimagecontainer.removeClass('fa-headphones fa-comment fa-comments fa-book-open-reader fa-chart-simple');\n            m.controls.modeimagecontainer.addClass('fa-circle-question');\n            // Show the quiz.\n           // m.controls.placeholder.hide();\n            m.controls.quizcontainer.show();\n        },\n\n        dohomelayout:function () {\n\n            var m = this;\n            m.controls.returnmenubutton.click();\n            //m.controls.modeimagecontainer.hide();\n        },\n        isandroid: function() {\n                if (/Android/i.test(navigator.userAgent)) {\n                    return true;\n                } else {\n                    return false;\n                }\n        }\n    };//end of returned object\n});//total end\n"],"names":["define","$","log","str","def","recorderhelper","modelaudiokaraoke","Ajax","notification","smallreporthelper","landr","quizhelper","debug","cmid","activitydata","holderid","recorderid","playerid","sorryboxid","controls","ra_recorder","rec_time_start","enableshadow","enablepreview","enablelandr","letsshadow","strings","passagefinished","clone","extend","this","init","props","dd","theid","widgetid","configcontrol","get","JSON","parse","value","remove","is_browser_ok","setupmodelaudio","setuplandr","setup_recorder","process_html","register_events","setup_strings","setupquiz","domenulayout","show","get_strings","component","done","s","i","confirm_cancel_recording","karaoke_opts","breaks","audioplayerclass","landr_opts","language","region","phonetics","stt_guided","attemptid","quizcontainer","opts","hider","introbox","progresscontainer","feedbackcontainer","errorcontainer","passagecontainer","recordingcontainer","dummyrecorder","recordercontainer","menubuttonscontainer","menuinstructionscontainer","previewinstructionscontainer","landrinstructionscontainer","activityinstructionscontainer","recinstructionscontainerright","recinstructionscontainerleft","allowearlyexit","wheretonextcontainer","modelaudioplayer","startlandrbutton","homebutton","startpreviewbutton","startreadingbutton","startreportbutton","startshadowbutton","startquizbutton","returnmenubutton","stopandplay","smallreportcontainer","readingcontainer","modeimagecontainer","homecontainer","navigator","mediaDevices","getUserMedia","beginall","passagerecorded","play","eventdata","Date","getTime","dopassagelayout","scrollIntoView","behaviour","block","inline","douploadlayout","currentTime","pause","rectime","Math","ceil","send_submission","mediaurl","dofinishedlayout","capturedspeech","speechresults","click","e","dopreviewlayout","keypress","which","preventDefault","dolandrlayout","doreadinglayout","isandroid","is","location","reload","hasClass","confirm","doreportlayout","doquizlayout","dohomelayout","filename","shadowing","call","methodname","args","ajaxresult","payloadobject","success","message","fail","exception","m","fadeOut","hide","removeClass","addClass","modeling","deactivate","containerfillscreen","console","attr","activate","fadeIn","doerrorlayout","test","userAgent"],"mappings":"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"}