{"version":3,"file":"quizcontroller.min.js","sources":["../src/quizcontroller.js"],"sourcesContent":["/* jshint ignore:start */\ndefine(['jquery', 'core/log','mod_readaloud/definitions','mod_readaloud/quizhelper','mod_readaloud/pollyhelper'], function($,  log, def,  quizhelper,polly) {\n\n    \"use strict\"; // jshint ;_;\n\n    log.debug('ReadAloud Quiz Controller: initialising');\n\n    return {\n\n        cmid: null,\n        quizdata: null,\n        sorryboxid: null,\n        controls: null,\n\n        //pass in config, the jquery video/audio object, and a function to be called when conversion has finshed\n        init: function(props){\n            var dd = this;\n\n            //pick up opts from html\n            var theid='#amdopts_' + props.widgetid;\n            var configcontrol = $(theid).get(0);\n            if(configcontrol){\n                dd.quizdata = JSON.parse(configcontrol.value);\n                $(theid).remove();\n            }else{\n                //if there is no config we might as well give up\n                log.debug('Readaloud quiz Controller: No config found on page. Giving up.');\n                return;\n            }\n\n            dd.cmid = props.cmid;\n            dd.attemptid = 1;\n            dd.sorryboxid = props.widgetid + '_sorrybox';\n\n            polly.init(dd.quizdata.token,dd.quizdata.region,dd.quizdata.owner);\n\n            dd.process_html();\n            dd.register_events();\n            // OR to show quiz and no recorder do dd.doquizlayout\n            dd.doquizlayout();\n        },\n\n        process_html: function(){\n            var opts = this.quizdata;\n            // These css classes/ids are all passed in from php in\n            // renderer.php::fetch_activity_amd\n            var controls = {\n                errorcontainer: $('.' +  opts['errorcontainer']),\n                feedbackcontainer: $('.' +  opts['feedbackcontainer']),\n                instructionscontainer: $('.' +  opts['instructionscontainer']),\n                introbox: $('.' + 'mod_intro_box'),\n                modeimagecontainer: $('#' + opts['modeimagecontainer']),\n                placeholder: $('.mod_readaloud_placeholder'),\n                quizcontainer: $('.' +  opts['quizcontainer']),\n                smallreportcontainer: $('#' + opts['smallreportcontainer']),\n                startquizbutton: $('#' + opts['startquizbutton']),\n                wheretonextcontainer: $('.' +  opts['wheretonextcontainer']),\n            };\n            this.controls = controls;\n        },\n\n        register_events: function() {\n            var dd = this;\n\n            dd.controls.startquizbutton.click(function(e){\n                dd.doquizlayout();\n            });\n        },\n\n        doquizlayout: function(){\n            var dd = this;\n\n            dd.controls.instructionscontainer.hide();\n            dd.controls.smallreportcontainer.hide();\n            dd.controls.modeimagecontainer.removeClass('preview landr readaloud readaloudshadow report');\n            dd.controls.modeimagecontainer.addClass('quiz');\n\n            // Set up the quiz.\n           // quizhelper.onSubmit = function(returndata){m.dofinishedreadinglayout(returndata);};\n            quizhelper.init(dd.controls.quizcontainer,\n                this.quizdata,\n                this.cmid,\n                this.attemptid,\n                polly);\n\n            // Show the quiz.\n            dd.controls.placeholder.hide();\n            dd.controls.quizcontainer.show();\n        },\n\n        doerrorlayout: function(){\n            this.controls.errorcontainer.show();\n            this.controls.wheretonextcontainer.show();\n        }\n    };// End of returned object.\n});// Total end.\n"],"names":["define","$","log","def","quizhelper","polly","debug","cmid","quizdata","sorryboxid","controls","init","props","dd","this","theid","widgetid","configcontrol","get","JSON","parse","value","remove","attemptid","token","region","owner","process_html","register_events","doquizlayout","opts","errorcontainer","feedbackcontainer","instructionscontainer","introbox","modeimagecontainer","placeholder","quizcontainer","smallreportcontainer","startquizbutton","wheretonextcontainer","click","e","hide","removeClass","addClass","show","doerrorlayout"],"mappings":"AACAA,sCAAO,CAAC,SAAU,WAAW,4BAA4B,2BAA2B,8BAA8B,SAASC,EAAIC,IAAKC,IAAMC,WAAWC,cAIjJH,IAAII,MAAM,2CAEH,CAEHC,KAAM,KACNC,SAAU,KACVC,WAAY,KACZC,SAAU,KAGVC,KAAM,SAASC,WACPC,GAAKC,KAGLC,MAAM,YAAcH,MAAMI,SAC1BC,cAAgBhB,EAAEc,OAAOG,IAAI,GAC9BD,eACCJ,GAAGL,SAAWW,KAAKC,MAAMH,cAAcI,OACvCpB,EAAEc,OAAOO,SAObT,GAAGN,KAAOK,MAAML,KAChBM,GAAGU,UAAY,EACfV,GAAGJ,WAAaG,MAAMI,SAAW,YAEjCX,MAAMM,KAAKE,GAAGL,SAASgB,MAAMX,GAAGL,SAASiB,OAAOZ,GAAGL,SAASkB,OAE5Db,GAAGc,eACHd,GAAGe,kBAEHf,GAAGgB,gBAbC3B,IAAII,MAAM,mEAgBlBqB,aAAc,eACNG,KAAOhB,KAAKN,SAGZE,SAAW,CACXqB,eAAgB9B,EAAE,IAAO6B,KAAI,gBAC7BE,kBAAmB/B,EAAE,IAAO6B,KAAI,mBAChCG,sBAAuBhC,EAAE,IAAO6B,KAAI,uBACpCI,SAAUjC,EAAE,kBACZkC,mBAAoBlC,EAAE,IAAM6B,KAAI,oBAChCM,YAAanC,EAAE,8BACfoC,cAAepC,EAAE,IAAO6B,KAAI,eAC5BQ,qBAAsBrC,EAAE,IAAM6B,KAAI,sBAClCS,gBAAiBtC,EAAE,IAAM6B,KAAI,iBAC7BU,qBAAsBvC,EAAE,IAAO6B,KAAI,4BAElCpB,SAAWA,UAGpBkB,gBAAiB,eACTf,GAAKC,KAETD,GAAGH,SAAS6B,gBAAgBE,OAAM,SAASC,GACvC7B,GAAGgB,mBAIXA,aAAc,eACNhB,GAAKC,KAETD,GAAGH,SAASuB,sBAAsBU,OAClC9B,GAAGH,SAAS4B,qBAAqBK,OACjC9B,GAAGH,SAASyB,mBAAmBS,YAAY,kDAC3C/B,GAAGH,SAASyB,mBAAmBU,SAAS,QAIxCzC,WAAWO,KAAKE,GAAGH,SAAS2B,cACxBvB,KAAKN,SACLM,KAAKP,KACLO,KAAKS,UACLlB,OAGJQ,GAAGH,SAAS0B,YAAYO,OACxB9B,GAAGH,SAAS2B,cAAcS,QAG9BC,cAAe,gBACNrC,SAASqB,eAAee,YACxBpC,SAAS8B,qBAAqBM"}