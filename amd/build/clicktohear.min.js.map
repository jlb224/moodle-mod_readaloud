{"version":3,"file":"clicktohear.min.js","sources":["../src/clicktohear.js"],"sourcesContent":["define(['jquery', 'core/log','mod_readaloud/definitions', 'mod_readaloud/pollyhelper'], function ($, log, def,pollyhelper) {\n    \"use strict\"; // jshint ;_;\n    /*\n    This file helps you get Polly URLs at runtime\n     */\n\n    log.debug('Click to hear: initialising');\n\n    return {\n        //controls\n        controls: {},\n        ttsvoice: 'Amy',\n\n        //class definitions\n        cd: {\n            hiddenplayerclass: def.hiddenplayer,\n            wordclass: def.wordclass,\n            passagecontainer: def.passagecontainer,\n            fullreportcontainer: def.fullreportcontainer,\n        },\n\n        //init the module\n        init: function(opts){\n            pollyhelper.init(opts.token,opts.region,opts.owner);\n            this.ttsvoice=opts.ttsvoice;\n            this.register_controls();\n            this.register_events();\n        },\n\n        //load all the controls so we do not have to do it later\n        register_controls: function(){\n            this.controls.audioplayer = $('#' + this.cd.hiddenplayerclass);\n            this.controls.component = $('#' + def.component);\n            this.controls.fullreportcontainer = $(\".\" + this.cd.fullreportcontainer);\n        },\n\n        //attach the various event handlers we need\n        register_events: function() {\n            var that = this;\n\n            // Get the audio element\n            var aplayer = this.controls.audioplayer;\n            pollyhelper.onnewpollyurl=function(theurl){\n                aplayer.attr('src',theurl);\n                aplayer[0].play();\n            };\n\n            //register click listener\n            //this is a delegated event handler because the elements are not there when we start\n            this.controls.component.on('click', \".\" + this.cd.fullreportcontainer +' .' + this.cd.wordclass, function () {\n                var wordnumber = parseInt($(this).attr('data-wordnumber'));\n                var word = $('#' + that.cd.wordclass + '_' + wordnumber);\n                var text = word.text();\n                pollyhelper.request_polly_url(text,\"text\",that.ttsvoice);\n            });\n        }//end of register events\n\n    };//end of return value\n});"],"names":["define","$","log","def","pollyhelper","debug","controls","ttsvoice","cd","hiddenplayerclass","hiddenplayer","wordclass","passagecontainer","fullreportcontainer","init","opts","token","region","owner","register_controls","register_events","audioplayer","this","component","that","aplayer","onnewpollyurl","theurl","attr","play","on","wordnumber","parseInt","text","request_polly_url"],"mappings":"AAAAA,mCAAO,CAAC,SAAU,WAAW,4BAA6B,8BAA8B,SAAUC,EAAGC,IAAKC,IAAIC,oBAM1GF,IAAIG,MAAM,+BAEH,CAEHC,SAAU,GACVC,SAAU,MAGVC,GAAI,CACAC,kBAAmBN,IAAIO,aACvBC,UAAWR,IAAIQ,UACfC,iBAAkBT,IAAIS,iBACtBC,oBAAqBV,IAAIU,qBAI7BC,KAAM,SAASC,MACXX,YAAYU,KAAKC,KAAKC,MAAMD,KAAKE,OAAOF,KAAKG,YACxCX,SAASQ,KAAKR,cACdY,yBACAC,mBAITD,kBAAmB,gBACVb,SAASe,YAAcpB,EAAE,IAAMqB,KAAKd,GAAGC,wBACvCH,SAASiB,UAAYtB,EAAE,IAAME,IAAIoB,gBACjCjB,SAASO,oBAAsBZ,EAAE,IAAMqB,KAAKd,GAAGK,sBAIxDO,gBAAiB,eACTI,KAAOF,KAGPG,QAAUH,KAAKhB,SAASe,YAC5BjB,YAAYsB,cAAc,SAASC,QAC/BF,QAAQG,KAAK,MAAMD,QACnBF,QAAQ,GAAGI,aAKVvB,SAASiB,UAAUO,GAAG,QAAS,IAAMR,KAAKd,GAAGK,oBAAqB,KAAOS,KAAKd,GAAGG,WAAW,eACzFoB,WAAaC,SAAS/B,EAAEqB,MAAMM,KAAK,oBAEnCK,KADOhC,EAAE,IAAMuB,KAAKhB,GAAGG,UAAY,IAAMoB,YAC7BE,OAChB7B,YAAY8B,kBAAkBD,KAAK,OAAOT,KAAKjB"}