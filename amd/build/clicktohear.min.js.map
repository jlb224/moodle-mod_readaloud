{"version":3,"file":"clicktohear.min.js","sources":["../src/clicktohear.js"],"sourcesContent":["define(['jquery', 'core/log','mod_readaloud/definitions', 'mod_readaloud/pollyhelper'], function ($, log, def,pollyhelper) {\r\n    \"use strict\"; // jshint ;_;\r\n    /*\r\n    This file helps you get Polly URLs at runtime\r\n     */\r\n\r\n    log.debug('Click to hear: initialising');\r\n\r\n    return {\r\n        //controls\r\n        controls: {},\r\n        ttsvoice: 'Amy',\r\n\r\n        //class definitions\r\n        cd: {\r\n            hiddenplayerclass: def.hiddenplayer,\r\n            wordclass: def.wordclass,\r\n            passagecontainer: def.passagecontainer,\r\n            fullreportcontainer: def.fullreportcontainer,\r\n        },\r\n\r\n        //init the module\r\n        init: function(opts){\r\n            pollyhelper.init(opts.token,opts.region,opts.owner);\r\n            this.ttsvoice=opts.ttsvoice;\r\n            this.register_controls();\r\n            this.register_events();\r\n        },\r\n\r\n        //load all the controls so we do not have to do it later\r\n        register_controls: function(){\r\n            this.controls.audioplayer = $('#' + this.cd.hiddenplayerclass);\r\n            this.controls.component = $('#' + def.component);\r\n            this.controls.fullreportcontainer = $(\".\" + this.cd.fullreportcontainer);\r\n        },\r\n\r\n        //attach the various event handlers we need\r\n        register_events: function() {\r\n            var that = this;\r\n\r\n            // Get the audio element\r\n            var aplayer = this.controls.audioplayer;\r\n            pollyhelper.onnewpollyurl=function(theurl){\r\n                aplayer.attr('src',theurl);\r\n                aplayer[0].play();\r\n            };\r\n\r\n            //register click listener\r\n            //this is a delegated event handler because the elements are not there when we start\r\n            this.controls.component.on('click', \".\" + this.cd.fullreportcontainer +' .' + this.cd.wordclass, function () {\r\n                var wordnumber = parseInt($(this).attr('data-wordnumber'));\r\n                var word = $('#' + that.cd.wordclass + '_' + wordnumber);\r\n                var text = word.text();\r\n                pollyhelper.request_polly_url(text,\"text\",that.ttsvoice);\r\n            });\r\n        }//end of register events\r\n\r\n    };//end of return value\r\n});"],"names":["define","$","log","def","pollyhelper","debug","controls","ttsvoice","cd","hiddenplayerclass","hiddenplayer","wordclass","passagecontainer","fullreportcontainer","init","opts","token","region","owner","register_controls","register_events","audioplayer","this","component","that","aplayer","onnewpollyurl","theurl","attr","play","on","wordnumber","parseInt","text","request_polly_url"],"mappings":"AAAAA,mCAAO,CAAC,SAAU,WAAW,4BAA6B,8BAA8B,SAAUC,EAAGC,IAAKC,IAAIC,oBAM1GF,IAAIG,MAAM,+BAEH,CAEHC,SAAU,GACVC,SAAU,MAGVC,GAAI,CACAC,kBAAmBN,IAAIO,aACvBC,UAAWR,IAAIQ,UACfC,iBAAkBT,IAAIS,iBACtBC,oBAAqBV,IAAIU,qBAI7BC,KAAM,SAASC,MACXX,YAAYU,KAAKC,KAAKC,MAAMD,KAAKE,OAAOF,KAAKG,YACxCX,SAASQ,KAAKR,cACdY,yBACAC,mBAITD,kBAAmB,gBACVb,SAASe,YAAcpB,EAAE,IAAMqB,KAAKd,GAAGC,wBACvCH,SAASiB,UAAYtB,EAAE,IAAME,IAAIoB,gBACjCjB,SAASO,oBAAsBZ,EAAE,IAAMqB,KAAKd,GAAGK,sBAIxDO,gBAAiB,eACTI,KAAOF,KAGPG,QAAUH,KAAKhB,SAASe,YAC5BjB,YAAYsB,cAAc,SAASC,QAC/BF,QAAQG,KAAK,MAAMD,QACnBF,QAAQ,GAAGI,aAKVvB,SAASiB,UAAUO,GAAG,QAAS,IAAMR,KAAKd,GAAGK,oBAAqB,KAAOS,KAAKd,GAAGG,WAAW,eACzFoB,WAAaC,SAAS/B,EAAEqB,MAAMM,KAAK,oBAEnCK,KADOhC,EAAE,IAAMuB,KAAKhB,GAAGG,UAAY,IAAMoB,YAC7BE,OAChB7B,YAAY8B,kBAAkBD,KAAK,OAAOT,KAAKjB"}